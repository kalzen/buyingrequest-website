const Y=String.prototype.replace,ee=/%20/g,V={RFC1738:"RFC1738",RFC3986:"RFC3986"},Q={RFC1738:function(s){return Y.call(s,ee,"+")},RFC3986:function(s){return String(s)}},te=V.RFC1738,L=V.RFC3986,T=Object.prototype.hasOwnProperty,$=Array.isArray,j=(function(){const s=[];for(let e=0;e<256;++e)s.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return s})(),ne=function(e){for(;e.length>1;){const t=e.pop(),n=t.obj[t.prop];if($(n)){const o=[];for(let i=0;i<n.length;++i)typeof n[i]<"u"&&o.push(n[i]);t.obj[t.prop]=o}}},re=function(e,t){const n=t&&t.plainObjects?Object.create(null):{};for(let o=0;o<e.length;++o)typeof e[o]<"u"&&(n[o]=e[o]);return n},oe=function s(e,t,n){if(!t)return e;if(typeof t!="object"){if($(e))e.push(t);else if(e&&typeof e=="object")(n&&(n.plainObjects||n.allowPrototypes)||!T.call(Object.prototype,t))&&(e[t]=!0);else return[e,t];return e}if(!e||typeof e!="object")return[e].concat(t);let o=e;return $(e)&&!$(t)&&(o=re(e,n)),$(e)&&$(t)?(t.forEach(function(i,r){if(T.call(e,r)){const c=e[r];c&&typeof c=="object"&&i&&typeof i=="object"?e[r]=s(c,i,n):e.push(i)}else e[r]=i}),e):Object.keys(t).reduce(function(i,r){const c=t[r];return T.call(i,r)?i[r]=s(i[r],c,n):i[r]=c,i},o)},ie=function(s,e,t){const n=s.replace(/\+/g," ");if(t==="iso-8859-1")return n.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(n)}catch{return n}},C=1024,se=function(e,t,n,o,i){if(e.length===0)return e;let r=e;if(typeof e=="symbol"?r=Symbol.prototype.toString.call(e):typeof e!="string"&&(r=String(e)),n==="iso-8859-1")return escape(r).replace(/%u[0-9a-f]{4}/gi,function(a){return"%26%23"+parseInt(a.slice(2),16)+"%3B"});let c="";for(let a=0;a<r.length;a+=C){const f=r.length>=C?r.slice(a,a+C):r,u=[];for(let d=0;d<f.length;++d){let l=f.charCodeAt(d);if(l===45||l===46||l===95||l===126||l>=48&&l<=57||l>=65&&l<=90||l>=97&&l<=122||i===te&&(l===40||l===41)){u[u.length]=f.charAt(d);continue}if(l<128){u[u.length]=j[l];continue}if(l<2048){u[u.length]=j[192|l>>6]+j[128|l&63];continue}if(l<55296||l>=57344){u[u.length]=j[224|l>>12]+j[128|l>>6&63]+j[128|l&63];continue}d+=1,l=65536+((l&1023)<<10|f.charCodeAt(d)&1023),u[u.length]=j[240|l>>18]+j[128|l>>12&63]+j[128|l>>6&63]+j[128|l&63]}c+=u.join("")}return c},le=function(e){const t=[{obj:{o:e},prop:"o"}],n=[];for(let o=0;o<t.length;++o){const i=t[o],r=i.obj[i.prop],c=Object.keys(r);for(let a=0;a<c.length;++a){const f=c[a],u=r[f];typeof u=="object"&&u!==null&&n.indexOf(u)===-1&&(t.push({obj:r,prop:f}),n.push(u))}}return ne(t),e},ae=function(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},ce=function(e,t){return[].concat(e,t)},q=function(e,t){if($(e)){const n=[];for(let o=0;o<e.length;o+=1)n.push(t(e[o]));return n}return t(e)},ue=Object.prototype.hasOwnProperty,M={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},O=Array.isArray,fe=Array.prototype.push,W=function(s,e){fe.apply(s,O(e)?e:[e])},de=Date.prototype.toISOString,H=L,m={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:se,encodeValuesOnly:!1,format:H,formatter:Q[H],indices:!1,serializeDate:function(e){return de.call(e)},skipNulls:!1,strictNullHandling:!1},ye=function(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"},F={},G=function(e,t,n,o,i,r,c,a,f,u,d,l,h,p,w,x,k,I){let y=e,A=I,P=0,_=!1;for(;(A=A.get(F))!==void 0&&!_;){const g=A.get(e);if(P+=1,typeof g<"u"){if(g===P)throw new RangeError("Cyclic object value");_=!0}typeof A.get(F)>"u"&&(P=0)}if(typeof u=="function"?y=u(t,y):y instanceof Date?y=h(y):n==="comma"&&O(y)&&(y=q(y,function(g){return g instanceof Date?h(g):g})),y===null){if(r)return f&&!x?f(t,m.encoder,k,"key",p):t;y=""}if(ye(y)||ae(y)){if(f){const g=x?t:f(t,m.encoder,k,"key",p);return[w(g)+"="+w(f(y,m.encoder,k,"value",p))]}return[w(t)+"="+w(String(y))]}const D=[];if(typeof y>"u")return D;let E;if(n==="comma"&&O(y))x&&f&&(y=q(y,f)),E=[{value:y.length>0?y.join(",")||null:void 0}];else if(O(u))E=u;else{const g=Object.keys(y);E=d?g.sort(d):g}const U=a?t.replace(/\./g,"%2E"):t,R=o&&O(y)&&y.length===1?U+"[]":U;if(i&&O(y)&&y.length===0)return R+"[]";for(let g=0;g<E.length;++g){const S=E[g],B=typeof S=="object"&&typeof S.value<"u"?S.value:y[S];if(c&&B===null)continue;const N=l&&a?S.replace(/\./g,"%2E"):S,X=O(y)?typeof n=="function"?n(R,N):R:R+(l?"."+N:"["+N+"]");I.set(e,P);const Z=new WeakMap;Z.set(F,I),W(D,G(B,X,n,o,i,r,c,a,n==="comma"&&x&&O(y)?null:f,u,d,l,h,p,w,x,k,Z))}return D},pe=function(e){if(!e)return m;if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.encodeDotInKeys<"u"&&typeof e.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");const t=e.charset||m.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let n=L;if(typeof e.format<"u"){if(!ue.call(Q,e.format))throw new TypeError("Unknown format option provided.");n=e.format}const o=Q[n];let i=m.filter;(typeof e.filter=="function"||O(e.filter))&&(i=e.filter);let r;if(e.arrayFormat in M?r=e.arrayFormat:"indices"in e?r=e.indices?"indices":"repeat":r=m.arrayFormat,"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const c=typeof e.allowDots>"u"?e.encodeDotInKeys===!0?!0:m.allowDots:!!e.allowDots;return{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:m.addQueryPrefix,allowDots:c,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:m.allowEmptyArrays,arrayFormat:r,charset:t,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:m.charsetSentinel,commaRoundTrip:e.commaRoundTrip,delimiter:typeof e.delimiter>"u"?m.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:m.encode,encodeDotInKeys:typeof e.encodeDotInKeys=="boolean"?e.encodeDotInKeys:m.encodeDotInKeys,encoder:typeof e.encoder=="function"?e.encoder:m.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:m.encodeValuesOnly,filter:i,format:n,formatter:o,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:m.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:m.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:m.strictNullHandling}};function he(s,e){let t=s;const n=pe(e);let o,i;typeof n.filter=="function"?(i=n.filter,t=i("",t)):O(n.filter)&&(i=n.filter,o=i);const r=[];if(typeof t!="object"||t===null)return"";const c=M[n.arrayFormat],a=c==="comma"&&n.commaRoundTrip;o||(o=Object.keys(t)),n.sort&&o.sort(n.sort);const f=new WeakMap;for(let l=0;l<o.length;++l){const h=o[l];n.skipNulls&&t[h]===null||W(r,G(t[h],h,c,a,n.allowEmptyArrays,n.strictNullHandling,n.skipNulls,n.encodeDotInKeys,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.format,n.formatter,n.encodeValuesOnly,n.charset,f))}const u=r.join(n.delimiter);let d=n.addQueryPrefix===!0?"?":"";return n.charsetSentinel&&(n.charset==="iso-8859-1"?d+="utf8=%26%2310003%3B&":d+="utf8=%E2%9C%93&"),u.length>0?d+u:""}const z=Object.prototype.hasOwnProperty,me=Array.isArray,v={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:ie,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},ge=function(s){return s.replace(/&#(\d+);/g,function(e,t){return String.fromCharCode(parseInt(t,10))})},J=function(s,e){return s&&typeof s=="string"&&e.comma&&s.indexOf(",")>-1?s.split(","):s},be="utf8=%26%2310003%3B",we="utf8=%E2%9C%93",je=function(e,t){const n={__proto__:null},o=t.ignoreQueryPrefix?e.replace(/^\?/,""):e,i=t.parameterLimit===1/0?void 0:t.parameterLimit,r=o.split(t.delimiter,i);let c=-1,a,f=t.charset;if(t.charsetSentinel)for(a=0;a<r.length;++a)r[a].indexOf("utf8=")===0&&(r[a]===we?f="utf-8":r[a]===be&&(f="iso-8859-1"),c=a,a=r.length);for(a=0;a<r.length;++a){if(a===c)continue;const u=r[a],d=u.indexOf("]="),l=d===-1?u.indexOf("="):d+1;let h,p;l===-1?(h=t.decoder(u,v.decoder,f,"key"),p=t.strictNullHandling?null:""):(h=t.decoder(u.slice(0,l),v.decoder,f,"key"),p=q(J(u.slice(l+1),t),function(x){return t.decoder(x,v.decoder,f,"value")})),p&&t.interpretNumericEntities&&f==="iso-8859-1"&&(p=ge(p)),u.indexOf("[]=")>-1&&(p=me(p)?[p]:p);const w=z.call(n,h);w&&t.duplicates==="combine"?n[h]=ce(n[h],p):(!w||t.duplicates==="last")&&(n[h]=p)}return n},Oe=function(s,e,t,n){let o=n?e:J(e,t);for(let i=s.length-1;i>=0;--i){let r;const c=s[i];if(c==="[]"&&t.parseArrays)r=t.allowEmptyArrays&&o===""?[]:[].concat(o);else{r=t.plainObjects?Object.create(null):{};const a=c.charAt(0)==="["&&c.charAt(c.length-1)==="]"?c.slice(1,-1):c,f=t.decodeDotInKeys?a.replace(/%2E/g,"."):a,u=parseInt(f,10);!t.parseArrays&&f===""?r={0:o}:!isNaN(u)&&c!==f&&String(u)===f&&u>=0&&t.parseArrays&&u<=t.arrayLimit?(r=[],r[u]=o):f!=="__proto__"&&(r[f]=o)}o=r}return o},xe=function(e,t,n,o){if(!e)return;const i=n.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,r=/(\[[^[\]]*])/,c=/(\[[^[\]]*])/g;let a=n.depth>0&&r.exec(i);const f=a?i.slice(0,a.index):i,u=[];if(f){if(!n.plainObjects&&z.call(Object.prototype,f)&&!n.allowPrototypes)return;u.push(f)}let d=0;for(;n.depth>0&&(a=c.exec(i))!==null&&d<n.depth;){if(d+=1,!n.plainObjects&&z.call(Object.prototype,a[1].slice(1,-1))&&!n.allowPrototypes)return;u.push(a[1])}return a&&u.push("["+i.slice(a.index)+"]"),Oe(u,t,n,o)},$e=function(e){return v};function Se(s,e){const t=$e();if(s===""||s===null||typeof s>"u")return t.plainObjects?Object.create(null):{};const n=typeof s=="string"?je(s,t):s;let o=t.plainObjects?Object.create(null):{};const i=Object.keys(n);for(let r=0;r<i.length;++r){const c=i[r],a=xe(c,n[c],t,typeof s=="string");o=oe(o,a,t)}return t.allowSparse===!0?o:le(o)}function b(){return b=Object.assign?Object.assign.bind():function(s){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(s[n]=t[n])}return s},b.apply(null,arguments)}class K{constructor(e,t,n){var o,i;this.name=e,this.definition=t,this.bindings=(o=t.bindings)!=null?o:{},this.wheres=(i=t.wheres)!=null?i:{},this.config=n}get template(){const e=`${this.origin}/${this.definition.uri}`.replace(/\/+$/,"");return e===""?"/":e}get origin(){return this.config.absolute?this.definition.domain?`${this.config.url.match(/^\w+:\/\//)[0]}${this.definition.domain}${this.config.port?`:${this.config.port}`:""}`:this.config.url:""}get parameterSegments(){var e,t;return(e=(t=this.template.match(/{[^}?]+\??}/g))==null?void 0:t.map(n=>({name:n.replace(/{|\??}/g,""),required:!/\?}$/.test(n)})))!=null?e:[]}matchesUrl(e){var t;if(!this.definition.methods.includes("GET"))return!1;const n=this.template.replace(/[.*+$()[\]]/g,"\\$&").replace(/(\/?){([^}?]*)(\??)}/g,(c,a,f,u)=>{var d;const l=`(?<${f}>${((d=this.wheres[f])==null?void 0:d.replace(/(^\^)|(\$$)/g,""))||"[^/?]+"})`;return u?`(${a}${l})?`:`${a}${l}`}).replace(/^\w+:\/\//,""),[o,i]=e.replace(/^\w+:\/\//,"").split("?"),r=(t=new RegExp(`^${n}/?$`).exec(o))!=null?t:new RegExp(`^${n}/?$`).exec(decodeURI(o));if(r){for(const c in r.groups)r.groups[c]=typeof r.groups[c]=="string"?decodeURIComponent(r.groups[c]):r.groups[c];return{params:r.groups,query:Se(i)}}return!1}compile(e){return this.parameterSegments.length?this.template.replace(/{([^}?]+)(\??)}/g,(t,n,o)=>{var i,r;if(!o&&[null,void 0].includes(e[n]))throw new Error(`Ziggy error: '${n}' parameter is required for route '${this.name}'.`);if(this.wheres[n]&&!new RegExp(`^${o?`(${this.wheres[n]})?`:this.wheres[n]}$`).test((r=e[n])!=null?r:""))throw new Error(`Ziggy error: '${n}' parameter '${e[n]}' does not match required format '${this.wheres[n]}' for route '${this.name}'.`);return encodeURI((i=e[n])!=null?i:"").replace(/%7C/g,"|").replace(/%25/g,"%").replace(/\$/g,"%24")}).replace(this.config.absolute?/(\.[^/]+?)(\/\/)/:/(^)(\/\/)/,"$1/").replace(/\/+$/,""):this.template}}class Ee extends String{constructor(e,t,n=!0,o){if(super(),this.t=o??(typeof Ziggy<"u"?Ziggy:globalThis?.Ziggy),!this.t&&typeof document<"u"&&document.getElementById("ziggy-routes-json")&&(globalThis.Ziggy=JSON.parse(document.getElementById("ziggy-routes-json").textContent),this.t=globalThis.Ziggy),this.t=b({},this.t,{absolute:n}),e){if(!this.t.routes[e])throw new Error(`Ziggy error: route '${e}' is not in the route list.`);this.i=new K(e,this.t.routes[e],this.t),this.o=this.u(t)}}toString(){const e=Object.keys(this.o).filter(t=>!this.i.parameterSegments.some(({name:n})=>n===t)).filter(t=>t!=="_query").reduce((t,n)=>b({},t,{[n]:this.o[n]}),{});return this.i.compile(this.o)+he(b({},e,this.o._query),{addQueryPrefix:!0,arrayFormat:"indices",encodeValuesOnly:!0,skipNulls:!0,encoder:(t,n)=>typeof t=="boolean"?Number(t):n(t)})}h(e){e?this.t.absolute&&e.startsWith("/")&&(e=this.l().host+e):e=this.m();let t={};const[n,o]=Object.entries(this.t.routes).find(([i,r])=>t=new K(i,r,this.t).matchesUrl(e))||[void 0,void 0];return b({name:n},t,{route:o})}m(){const{host:e,pathname:t,search:n}=this.l();return(this.t.absolute?e+t:t.replace(this.t.url.replace(/^\w*:\/\/[^/]+/,""),"").replace(/^\/+/,"/"))+n}current(e,t){const{name:n,params:o,query:i,route:r}=this.h();if(!e)return n;const c=new RegExp(`^${e.replace(/\./g,"\\.").replace(/\*/g,".*")}$`).test(n);if([null,void 0].includes(t)||!c)return c;const a=new K(n,r,this.t);t=this.u(t,a);const f=b({},o,i);if(Object.values(t).every(d=>!d)&&!Object.values(f).some(d=>d!==void 0))return!0;const u=(d,l)=>Object.entries(d).every(([h,p])=>Array.isArray(p)&&Array.isArray(l[h])?p.every(w=>l[h].includes(w)||l[h].includes(decodeURIComponent(w))):typeof p=="object"&&typeof l[h]=="object"&&p!==null&&l[h]!==null?u(p,l[h]):l[h]==p||l[h]==decodeURIComponent(p));return u(t,f)}l(){var e,t,n,o,i,r;const{host:c="",pathname:a="",search:f=""}=typeof window<"u"?window.location:{};return{host:(e=(t=this.t.location)==null?void 0:t.host)!=null?e:c,pathname:(n=(o=this.t.location)==null?void 0:o.pathname)!=null?n:a,search:(i=(r=this.t.location)==null?void 0:r.search)!=null?i:f}}get params(){const{params:e,query:t}=this.h();return b({},e,t)}get routeParams(){return this.h().params}get queryParams(){return this.h().query}has(e){return this.t.routes.hasOwnProperty(e)}u(e={},t=this.i){e!=null||(e={}),e=["string","number"].includes(typeof e)?[e]:e;const n=t.parameterSegments.filter(({name:o})=>!this.t.defaults[o]);return Array.isArray(e)?e=e.reduce((o,i,r)=>b({},o,n[r]?{[n[r].name]:i}:typeof i=="object"?i:{[i]:""}),{}):n.length!==1||e[n[0].name]||!e.hasOwnProperty(Object.values(t.bindings)[0])&&!e.hasOwnProperty("id")||(e={[n[0].name]:e}),b({},this.p(t),this.$(e,t))}p(e){return e.parameterSegments.filter(({name:t})=>this.t.defaults[t]).reduce((t,{name:n},o)=>b({},t,{[n]:this.t.defaults[n]}),{})}$(e,{bindings:t,parameterSegments:n}){return Object.entries(e).reduce((o,[i,r])=>{if(!r||typeof r!="object"||Array.isArray(r)||!n.some(({name:c})=>c===i))return b({},o,{[i]:r});if(!r.hasOwnProperty(t[i])){if(!r.hasOwnProperty("id"))throw new Error(`Ziggy error: object passed as '${i}' parameter is missing route model binding key '${t[i]}'.`);t[i]="id"}return b({},o,{[i]:r[t[i]]})},{})}valueOf(){return this.toString()}}function ke(s,e,t,n){const o=new Ee(s,e,t,n);return s?o.toString():o}export{ke as s};
